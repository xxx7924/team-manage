<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <!-- <meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="tmtmi-english">
    <title>밸런스 팀짜기</title>

    <!-- 웹 폰트 -->
    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR&display=swap" rel="stylesheet">

    <style>
        #header {
            height: 80px;
            padding: 10px 10px;
            background: #2e303e;
            color: #fff;
            text-align:center;
            font-size: 12px; 
        }
        #main {
            color: #434b4f;
        }

        #main .selected_list {
            margin-top: 50px;
        }
        #main .total-list {
            margin-top: 50px;
        }

        #main .red_list {
            margin-top: 50px;
        }

        #main .grean_list {
            margin-top: 50px;
        }

        div h2 {
            padding: 0px 0px 0px 10px;
        }

        div p {
            padding: 0px 0px 0px 10px;
        }
        
        ul {
            list-style: none;
            padding: 0px;
            margin: 0px;
            text-align:center;
        }

        ul li {
            margin: 10px 10px 10px 10px;
            padding: 15px 10px 10px 10px;
            height: 40px;
            font-size: 24px; 
            border: 1px solid gray;
            border-radius: 5px;

        }

        ul li span {
            margin: 0px 10px 0px 0px;
        }

        #selected_members li {
            background: #3d5b95;
            color: #fff;

        }

        #red_members li {
            background: #EF4040;
            color: #fff;
        }

        #grean_members li {
            background: #65B741;
            color: #fff;
        }

        #score1, #score2 {
            padding: 0px 0px 0px 10px;
        }

        .button_area1 {
            
            margin: 30px 0px 0px 0px;
        }

        .button_area1 div {
            
            margin: 10px 10px 10px 10px;
            padding: 20px 10px 10px 10px;
            height: 40px;
            background: #090A0B;
            color: white;
            text-align: center;
            border-radius: 5px;
            font-size: 18px; 
        }

        /* 컨테이너 */
        .container {width: 1200px; margin: 0 auto;}

        #footer {height: 130px; background: #2e303e; color: white; text-align: center; padding: 20px 0px 5px 0px; margin: 50px 0px 0px 0px;}

        /* mediaquery */
        /* 화면 너비 0~1220px */
        @media (max-width: 1220px){
            .container {width: 100%;}
        }

      </style>



</head>
<body>
    
	<header id="header">
		<div class="container">
			<div class="header">
            	<h1>슈퍼썬데이FC</h1>
            </div>
		</div>
	</header>

    <main id="main">
        <div class="container">
            <div class="main">
            	
                <div class="selected_list">
                    <h2>참여멤버<span id="member_cnt"> 0명</span></h2>
                    <p>참석한 멤버를 선택해주세요.</p>
                    <ul id="selected_members">

                    </ul>
                </div>

                <div class="button_area1">
                    <div id="start1">팀편성 하기</div>
                    <div id="start2">다시 하기</div>
                </div>
                
                <div class="total-list">
                    <h2>전체멤버</h2>
                    <ul id="total-members">
                        <!-- <li id="83김김김" data-age="83" data-name="김김김" data-level="6"><span>83</span>김김김</li>
                        <li id="82김이이" data-age="82" data-name="김이이" data-level="5"><span>82</span>김이이</li>
                        <li id="85김차차" data-age="85" data-name="김차차" data-level="4"><span>85</span>김차차</li>
                        <li id="83김오오" data-age="83" data-name="김오오" data-level="3"><span>83</span>김오오</li>
                        <li id="83김구구" data-age="83" data-name="김구구" data-level="1"><span>83</span>김구구</li>
                        <li id="83김사사" data-age="83" data-name="김사사" data-level="2"><span>83</span>김사사</li> -->
                    </ul>
                </div>

                <div class="red_list" style="display: none;">
                    <h2>주황팀</h2>
                    <div id="score1"></div>
                    <ul id="red_members">

                    </ul>
                </div>

                <div class="grean_list" style="display: none;">
                    <h2>녹색팀</h2>
                    <div id="score2"></div>
                    <ul id="grean_members">

                    </ul>
                </div>
          
            </div>
        </div>
    </main>
    
    <footer id="footer">
        <h2>밸런스 팀짜기 © 2023</h2>
    </footer>






    
    <!-- JavaScript Libraries -->
    <script src="jquery.min_1.12.4.js"></script>
    <script src="modernizr-custom.js"></script>


    <script type="text/javascript">
    	

        function member(age, name, power) {
            this.age = age;
            this.name = name;
            this.power = power;
        }

        // 플레이어 배열 생성
        var members = [
            
            //년생,이름,능력치
            //6점
            new member("89", "스프링",  "6"),
            new member("92", "용용",    "6"),
            new member("73", "레오",    "6"),

            //5점
            new member("78", "콩바페",  "5"),
            new member("74", "엘리",    "5"),
            new member("80", "루키",    "5"),

            //4점
            new member("84", "유유",     "4"),
            new member("75", "퀵실버",   "4"),
            new member("78", "시리우스", "4"),

            //3점
            new member("73", "킹날두",   "3"),
            new member("75", "이삭",     "3"),
            new member("83", "조이",     "3"),
            new member("81", "포메",     "3"),
            new member("89", "젤리",     "3"),
            new member("84", "코카",     "3"),
            new member("78", "체리",     "3"),

            //2점
            new member("87", "써니",     "2"),
            new member("84", "토마토",   "2"),
            new member("86", "또또",     "2"),
            new member("86", "티케",     "2"),
            new member("94", "슬리",     "2"),
            new member("92", "조니츄",   "2"),
            
            //1점
            new member("92", "바티",     "1"),
            new member("85", "우리",     "1"),



            
            
            //대기멤버
            //new member("82", "하니", "5"),
            //new member("89", "둘기", "5"),
            

        ];




        var selecedMemberCnt = 0;

        var players = [];
        // 팀 배열 생성
        var teamA = [];
        var teamB = [];

        // 각 팀의 능력치 합계 계산
        var teamAPowerSum = 0;
        var teamBPowerSum = 0;
		
		$(document).ready(function(){
			

            initMember();



			$("#total-members li").on("click", function () {
				var id = $(this).attr("id");
                var data_age = $(this).attr("data-age");
                var data_name = $(this).attr("data-name");
                var data_level = $(this).attr("data-level");
                
                console.log("id : "+id);
                console.log("data_age : "+data_age);
                console.log("data_name : "+data_name);
                console.log("data_level : "+data_level);

                $('#'+id).css('display', 'none');

                var id2 = id + "-1";

                var html = '<li id="'+id2+'" data-age="'+data_age+'" data-name="'+data_name+'" data-level="'+data_level+'"><span>'+data_age+'</span>'+data_name+'</li>';
                $("#selected_members").append(html);

                selecedMemberCnt++;
                $("#member_cnt").text(" "+selecedMemberCnt+"명");

			});

            $("#selected_members").on("click", "li", function () {
				var id = $(this).attr("id");
                var data_age = $(this).attr("data-age");
                var data_name = $(this).attr("data-name");
                var data_level = $(this).attr("data-level");
                
                console.log("id : "+id);
                console.log("data_age : "+data_age);
                console.log("data_name : "+data_name);
                console.log("data_level : "+data_level);

                var targetId = id.split("-");

                $('#'+targetId[0]).css('display', 'block');

                $(this).remove();

                selecedMemberCnt--;
                $("#member_cnt").text(" "+selecedMemberCnt+"명");

			});

            $("#start1").on("click", function () {
				
                if(selecedMemberCnt == 0){
                    alert("멤버를 선택해 주세요.");
                    return false;
                }

                $("#selected_members li").each(function( index, element ) {
                    var data_age = $(this).attr("data-age");
                    var data_name = $(this).attr("data-name");
                    var data_level = $(this).attr("data-level");

                    var player = {};
                    player.age = data_age;
                    player.name = data_name;
                    player.level = Number(data_level);

                    players.push(player);

                });

                shuffleArray(players);

                console.log(JSON.stringify(players, null, 2));

                // 플레이어를 능력치를 기준으로 내림차순 정렬
                players.sort(function(a, b) {
                    return b.level - a.level;
                });

                console.log(JSON.stringify(players, null, 2));

                // 플레이어 할당 시작
                assignPlayersToTeams(0);

                //양팀 멤버수 체크 후 재배치
                balancePlayersToTeams();



                // 결과 출력
                console.log("Team A:", teamA);
                console.log("Team B:", teamB);
                console.log("능력치 차이:", Math.abs(teamAPowerSum - teamBPowerSum));


                $('.total-list').css('display', 'none');
                $('.selected_list').css('display', 'none');

                $('.red_list').css('display', 'block');
                $('.grean_list').css('display', 'block');

                $('#start1').css('display', 'none');

                teamA.sort(function(a, b) {
                    return b.age - a.age;
                });

                teamB.sort(function(a, b) {
                    return b.age - a.age;
                });

                for (var i = 0; i < teamA.length; i++){

                    var html = '<li><span>'+teamA[i].age+'</span>'+teamA[i].name+'</li>';
                    $("#red_members").append(html);

                }

                for (var i = 0; i < teamB.length; i++){

                    var html = '<li><span>'+teamB[i].age+'</span>'+teamB[i].name+'</li>';
                    $("#grean_members").append(html);

                }

                //주황팀 능력치 합
                $('#score1').text("능력치 합 : "+teamAPowerSum);

                //녹색팀 능력치 합
                $('#score2').text("능력치 합 : "+teamBPowerSum);


			});

            $("#start2").on("click", function () {

                location.reload();

            });



		});


        // 팀에 플레이어 할당하는 함수
        function assignPlayersToTeams(index) {
            if (index === players.length) {
                return;
            }

            // 능력치 합이 작은 팀에 플레이어 할당
            if (teamAPowerSum <= teamBPowerSum) {
                
                console.log("teamA.push"+JSON.stringify(players[index], null, 2));
                teamA.push(players[index]);
                teamAPowerSum += players[index].level;
            } else {
                console.log("teamB.push"+JSON.stringify(players[index], null, 2));
                teamB.push(players[index]);
                teamBPowerSum += players[index].level;
            }

            // 다음 플레이어 할당을 위해 재귀 호출
            assignPlayersToTeams(index + 1);
        }

        //두팀의 멤버수가 1개 이상 안나도록 재배치하는 함수
        function balancePlayersToTeams() {
            
            var cnt = teamA.length - teamB.length;
            console.log("cnt:", cnt);
            
            if (cnt === -1 || cnt === 0 || cnt === 1) {
                return;
            }

            if(teamA.length > teamB.length){
                //A팀 가장 레벨 낮은 멤버를 B팀에 추가
                var lastPlayer = teamA.pop();
                teamB.push(lastPlayer);
            }else{
                //B팀 가장 레벨 낮은 멤버를 A팀에 추가
                var lastPlayer = teamB.pop();
                teamA.push(lastPlayer);
            }

            // 다음 플레이어 할당을 위해 재귀 호출
            balancePlayersToTeams();
        }

        function initMember() {
            
            members.sort(function(a, b) {
                return a.age - b.age;
            });
            
            for (var i = 0; i < members.length; i++){

                var id = members[i].age+members[i].name;
                var age = members[i].age;
                var name = members[i].name;
                var power = members[i].power;

                var html = '<li id="'+id+'" data-age="'+age+'" data-name="'+name+'" data-level="'+power+'"><span>'+age+'</span>'+name+'</li>';
                $("#total-members").append(html);

            }
        }

        //랜덤 섞기
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
		
    </script>

</body>
</html>